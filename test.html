<!doctype html>
<html>
    <head>
            <title>Project Shapeoko</title>
            <!--include styles-->
            <link href='http://fonts.googleapis.com/css?family=Ubuntu:300,400,700' rel='stylesheet' type='text/css'>
            <link href="shapeoko.css" rel="stylesheet" />
            <link href="slimbox.css" rel="stylesheet" />
            <!--include javascript-->
            <script src="js/markdown.js"></script>
            <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
            <script src="js/slimbox2.js"></script>
    </head>
    
    <body>

        <script>
            //load the navbar
            $("body").load("include.html");
        </script>    

 
        <script>
            $(document).ready(function(){
                $.ajax({
                  //change this path to the appropriate markdown file
                  url:"content/index.md",
                  dataType: "text",
                  success: function(response){
                      
                      //here is the magic. convert markdown to html, inject it into content div
                      $("#content").append(markdown.toHTML(response));

                      // now that the images exist in the dom, lightbox them!
                      lightboxImages()
                    }
                });

                //rename the page
                document.title = 'Shapeoko 2 Documentation';

            });

            function lightboxImages(){
              // Wrap each image in a link
              $("img").each(function(){

                var src = $(this).attr('src');

                //grab the original extension (jpg,png,svg,etc)
                var ext = src.split('.').pop();

                //change the src to the original big image.
                //This is the filename minus the last 2 chars before the extension
                //strip off the last 6 characters (3 digit extension + period + 2 chars denoting size)
                src = src.slice(0,-6);

                //add everything back together (sans 2 chars denoting size)
                src = src + "." + ext;


                // then wrap the image with a link to activate the lightbox
                $(this).wrap("<a href='"+src+"' rel='lightbox'></a>")
              });

              // Because these elements were all added after dom ready
              // we need to explicitly tell slimbox to 
              // listen to the new links
              $("a[rel=lightbox]").slimbox()
            }
        </script>

    </body>
</html> 